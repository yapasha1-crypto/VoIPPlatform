2026-01-07 22:30:13 [INF] ðŸš€ ØªØ·Ø¨ÙŠÙ‚ VoIPPlatform Ù‚ÙŠØ¯ Ø§Ù„Ø¥Ø·Ù„Ø§Ù‚...
2026-01-07 22:30:14 [INF] âœ… Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªÙ‚Ø¨Ø§Ù„
2026-01-07 22:30:14 [INF] User profile is available. Using 'C:\Users\mejer\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2026-01-07 22:30:15 [INF] Now listening on: https://localhost:7257
2026-01-07 22:30:15 [INF] Now listening on: http://localhost:5004
2026-01-07 22:30:15 [INF] Application started. Press Ctrl+C to shut down.
2026-01-07 22:30:15 [INF] Hosting environment: Development
2026-01-07 22:30:15 [INF] Content root path: C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API
2026-01-07 22:32:48 [INF] Request starting HTTP/1.1 GET http://localhost:5004/ - null null
2026-01-07 22:32:48 [INF] Request finished HTTP/1.1 GET http://localhost:5004/ - 301 0 null 144.2541ms
2026-01-07 22:32:48 [INF] Request starting HTTP/1.1 GET http://localhost:5004/index.html - null null
2026-01-07 22:32:48 [INF] Request finished HTTP/1.1 GET http://localhost:5004/index.html - 200 null text/html;charset=utf-8 327.092ms
2026-01-07 22:32:49 [INF] Request starting HTTP/1.1 GET http://localhost:5004/swagger-ui.css - null null
2026-01-07 22:32:49 [INF] Request starting HTTP/1.1 GET http://localhost:5004/swagger-ui-standalone-preset.js - null null
2026-01-07 22:32:49 [INF] Request starting HTTP/1.1 GET http://localhost:5004/swagger-ui-bundle.js - null null
2026-01-07 22:32:49 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2026-01-07 22:32:49 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2026-01-07 22:32:49 [INF] Request finished HTTP/1.1 GET http://localhost:5004/swagger-ui-standalone-preset.js - 200 230280 text/javascript 248.4897ms
2026-01-07 22:32:49 [INF] Request finished HTTP/1.1 GET http://localhost:5004/swagger-ui.css - 200 152034 text/css 259.7288ms
2026-01-07 22:32:49 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2026-01-07 22:32:49 [INF] Request finished HTTP/1.1 GET http://localhost:5004/swagger-ui-bundle.js - 200 1456926 text/javascript 338.4854ms
2026-01-07 22:32:49 [INF] Request starting HTTP/1.1 GET http://localhost:5004/swagger/v1/swagger.json - null null
2026-01-07 22:32:49 [INF] Request starting HTTP/1.1 GET http://localhost:5004/favicon-32x32.png - null null
2026-01-07 22:32:49 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2026-01-07 22:32:49 [INF] Request finished HTTP/1.1 GET http://localhost:5004/favicon-32x32.png - 200 628 image/png 8.577ms
2026-01-07 22:32:50 [INF] Request finished HTTP/1.1 GET http://localhost:5004/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 350.2651ms
2026-01-07 22:34:04 [INF] Request starting HTTP/2 GET https://localhost:7257/index.html - null null
2026-01-07 22:34:04 [INF] Request finished HTTP/2 GET https://localhost:7257/index.html - 200 null text/html;charset=utf-8 8.2199ms
2026-01-07 22:34:05 [INF] Request starting HTTP/2 GET https://localhost:7257/swagger/v1/swagger.json - null null
2026-01-07 22:34:05 [INF] Request finished HTTP/2 GET https://localhost:7257/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 65.7659ms
2026-01-07 22:34:34 [INF] Request starting HTTP/2 GET https://localhost:7257/dashboard/sms - null null
2026-01-07 22:34:34 [INF] Request finished HTTP/2 GET https://localhost:7257/dashboard/sms - 404 0 null 295.9439ms
2026-01-07 22:34:34 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7257/dashboard/sms, Response status code: 404
2026-01-07 22:36:47 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - null null
2026-01-07 22:36:47 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - null null
2026-01-07 22:36:47 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - null null
2026-01-07 22:36:47 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - null null
2026-01-07 22:36:47 [INF] CORS policy execution successful.
2026-01-07 22:36:47 [INF] CORS policy execution successful.
2026-01-07 22:36:47 [INF] CORS policy execution successful.
2026-01-07 22:36:47 [INF] CORS policy execution successful.
2026-01-07 22:36:47 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - 204 null null 35.5369ms
2026-01-07 22:36:47 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - 204 null null 33.6965ms
2026-01-07 22:36:47 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - 204 null null 35.3001ms
2026-01-07 22:36:47 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - 204 null null 37.4508ms
2026-01-07 22:36:47 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:36:47 [INF] CORS policy execution successful.
2026-01-07 22:36:47 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:47'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2026-01-07 22:36:47 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:47'.
2026-01-07 22:36:47 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2026-01-07 22:36:47 [INF] AuthenticationScheme: Bearer was challenged.
2026-01-07 22:36:47 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 401 0 null 366.882ms
2026-01-07 22:36:47 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:36:47 [INF] CORS policy execution successful.
2026-01-07 22:36:47 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:47'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2026-01-07 22:36:47 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:47'.
2026-01-07 22:36:47 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2026-01-07 22:36:47 [INF] AuthenticationScheme: Bearer was challenged.
2026-01-07 22:36:47 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 401 0 null 85.8529ms
2026-01-07 22:36:47 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:36:47 [INF] CORS policy execution successful.
2026-01-07 22:36:47 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:47'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2026-01-07 22:36:47 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:47'.
2026-01-07 22:36:47 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2026-01-07 22:36:47 [INF] AuthenticationScheme: Bearer was challenged.
2026-01-07 22:36:47 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 401 0 null 68.4374ms
2026-01-07 22:36:47 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:36:48 [INF] CORS policy execution successful.
2026-01-07 22:36:48 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:48'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2026-01-07 22:36:48 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:48'.
2026-01-07 22:36:48 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2026-01-07 22:36:48 [INF] AuthenticationScheme: Bearer was challenged.
2026-01-07 22:36:48 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 401 0 null 356.5074ms
2026-01-07 22:36:48 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:36:48 [INF] CORS policy execution successful.
2026-01-07 22:36:48 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:48'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2026-01-07 22:36:48 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:48'.
2026-01-07 22:36:48 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2026-01-07 22:36:48 [INF] AuthenticationScheme: Bearer was challenged.
2026-01-07 22:36:48 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 401 0 null 22.1958ms
2026-01-07 22:36:48 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:36:48 [INF] CORS policy execution successful.
2026-01-07 22:36:48 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:48'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2026-01-07 22:36:48 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:48'.
2026-01-07 22:36:48 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2026-01-07 22:36:48 [INF] AuthenticationScheme: Bearer was challenged.
2026-01-07 22:36:48 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 401 0 null 15.8127ms
2026-01-07 22:36:48 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:36:48 [INF] CORS policy execution successful.
2026-01-07 22:36:48 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:48'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2026-01-07 22:36:48 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:48'.
2026-01-07 22:36:48 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2026-01-07 22:36:48 [INF] AuthenticationScheme: Bearer was challenged.
2026-01-07 22:36:48 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 401 0 null 21.1822ms
2026-01-07 22:36:48 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:36:48 [INF] CORS policy execution successful.
2026-01-07 22:36:48 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:48'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateTokenPayloadAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
   at Microsoft.IdentityModel.JsonWebTokens.JsonWebTokenHandler.ValidateJWSAsync(JsonWebToken jsonWebToken, TokenValidationParameters validationParameters, BaseConfiguration configuration)
2026-01-07 22:36:48 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo (UTC): '05/01/2026 23:31:14', Current time (UTC): '07/01/2026 21:36:48'.
2026-01-07 22:36:48 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2026-01-07 22:36:48 [INF] AuthenticationScheme: Bearer was challenged.
2026-01-07 22:36:48 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 401 0 null 25.1273ms
2026-01-07 22:37:51 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/login - null null
2026-01-07 22:37:51 [INF] CORS policy execution successful.
2026-01-07 22:37:51 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/login - 204 null null 5.5789ms
2026-01-07 22:37:51 [INF] Request starting HTTP/2 POST https://localhost:7257/api/Auth/login - application/json 45
2026-01-07 22:37:51 [INF] CORS policy execution successful.
2026-01-07 22:37:51 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.AuthController.Login (VoIPPlatform.API)'
2026-01-07 22:37:51 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest) on controller VoIPPlatform.API.Controllers.AuthController (VoIPPlatform.API).
2026-01-07 22:37:53 [WRN] No store type was specified for the decimal property 'LocalBalance' on entity type 'CustomerAccount'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2026-01-07 22:38:08 [INF] Executed DbCommand (263ms) [Parameters=[@__request_Username_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Username] = @__request_Username_0
2026-01-07 22:38:08 [INF] Login Debug - User: TestUser02
2026-01-07 22:38:08 [INF] Login Debug - Stored Hash: jZae727K08KaOmKSgOaGzww/XVqGr/PKEgIMkjrcbJI=
2026-01-07 22:38:08 [INF] Login Debug - Input Password Length: 6
2026-01-07 22:38:08 [INF] Login Debug - Input Hash:  jZae727K08KaOmKSgOaGzww/XVqGr/PKEgIMkjrcbJI=
2026-01-07 22:38:08 [INF] Login Debug - Match: true
2026-01-07 22:38:09 [INF] Executed DbCommand (89ms) [Parameters=[@p13='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [AccountBalance] = @p0, [CreatedAt] = @p1, [Email] = @p2, [FirstName] = @p3, [IsActive] = @p4, [IsEmailVerified] = @p5, [LastLoginAt] = @p6, [LastName] = @p7, [PasswordHash] = @p8, [PhoneNumber] = @p9, [Role] = @p10, [UpdatedAt] = @p11, [Username] = @p12
OUTPUT 1
WHERE [Id] = @p13;
2026-01-07 22:38:09 [INF] Successful login: TestUser02
2026-01-07 22:38:09 [INF] Start processing HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02&customerpassword=123456
2026-01-07 22:38:09 [INF] Sending HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02&customerpassword=123456
2026-01-07 22:38:09 [INF] Received HTTP response headers after 434.442ms - 200
2026-01-07 22:38:09 [INF] End processing HTTP request after 449.8598ms - 200
2026-01-07 22:38:09 [INF] GetUserInfo Response: <?xml version="1.0"?>
<!DOCTYPE GetUserInfo>
<GetUserInfo>
  <Customer>TestUser02*prov</Customer>
  <Balance>1</Balance>
  <SpecificBalance>1</SpecificBalance>
  <Blocked>False</Blocked>
  <EmailAddress />
  <GeocallCLI>+1234567890</GeocallCLI>
</GetUserInfo>
2026-01-07 22:38:09 [INF] Executed DbCommand (2ms) [Parameters=[@p13='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = DateTime2), @p2='?' (Size = 450), @p3='?' (Size = 4000), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = DateTime2), @p7='?' (Size = 4000), @p8='?' (Size = 4000), @p9='?' (Size = 4000), @p10='?' (Size = 4000), @p11='?' (DbType = DateTime2), @p12='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Users] SET [AccountBalance] = @p0, [CreatedAt] = @p1, [Email] = @p2, [FirstName] = @p3, [IsActive] = @p4, [IsEmailVerified] = @p5, [LastLoginAt] = @p6, [LastName] = @p7, [PasswordHash] = @p8, [PhoneNumber] = @p9, [Role] = @p10, [UpdatedAt] = @p11, [Username] = @p12
OUTPUT 1
WHERE [Id] = @p13;
2026-01-07 22:38:09 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType2`3[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType10`5[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType9`3[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-07 22:38:09 [INF] Executed action VoIPPlatform.API.Controllers.AuthController.Login (VoIPPlatform.API) in 18179.9638ms
2026-01-07 22:38:09 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.AuthController.Login (VoIPPlatform.API)'
2026-01-07 22:38:09 [INF] Request finished HTTP/2 POST https://localhost:7257/api/Auth/login - 200 null application/json; charset=utf-8 18353.6124ms
2026-01-07 22:38:09 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - null null
2026-01-07 22:38:09 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - null null
2026-01-07 22:38:09 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - null null
2026-01-07 22:38:09 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - null null
2026-01-07 22:38:09 [INF] CORS policy execution successful.
2026-01-07 22:38:10 [INF] CORS policy execution successful.
2026-01-07 22:38:10 [INF] CORS policy execution successful.
2026-01-07 22:38:10 [INF] CORS policy execution successful.
2026-01-07 22:38:10 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - 204 null null 29.6449ms
2026-01-07 22:38:10 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - 204 null null 31.9912ms
2026-01-07 22:38:10 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - 204 null null 31.6994ms
2026-01-07 22:38:10 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:38:10 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - 204 null null 31.7966ms
2026-01-07 22:38:10 [INF] CORS policy execution successful.
2026-01-07 22:38:10 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:38:10 [INF] Route matched with {action = "GetMe", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller VoIPPlatform.API.Controllers.AuthController (VoIPPlatform.API).
2026-01-07 22:38:10 [INF] Executed DbCommand (4ms) [Parameters=[@__username_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Username] = @__username_0
2026-01-07 22:38:10 [INF] Start processing HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:38:10 [INF] Sending HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:38:10 [INF] Received HTTP response headers after 65.8599ms - 200
2026-01-07 22:38:10 [INF] End processing HTTP request after 70.9208ms - 200
2026-01-07 22:38:10 [INF] GetUserInfo Response: <?xml version="1.0"?>
<!DOCTYPE GetUserInfo>
<GetUserInfo>
  <Customer>TestUser02*prov</Customer>
  <Balance>1</Balance>
  <SpecificBalance>1</SpecificBalance>
  <Blocked>False</Blocked>
  <EmailAddress />
  <GeocallCLI>+1234567890</GeocallCLI>
</GetUserInfo>
2026-01-07 22:38:10 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType11`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType12`6[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-07 22:38:10 [INF] Executed action VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API) in 121.7644ms
2026-01-07 22:38:10 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:38:10 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:38:10 [INF] CORS policy execution successful.
2026-01-07 22:38:10 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 200 null application/json; charset=utf-8 198.3427ms
2026-01-07 22:38:10 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:38:10 [INF] Route matched with {action = "GetMe", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller VoIPPlatform.API.Controllers.AuthController (VoIPPlatform.API).
2026-01-07 22:38:10 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Username] = @__username_0
2026-01-07 22:38:10 [INF] Start processing HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:38:10 [INF] Sending HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:38:10 [INF] Received HTTP response headers after 69.8446ms - 200
2026-01-07 22:38:10 [INF] End processing HTTP request after 82.8308ms - 200
2026-01-07 22:38:10 [INF] GetUserInfo Response: <?xml version="1.0"?>
<!DOCTYPE GetUserInfo>
<GetUserInfo>
  <Customer>TestUser02*prov</Customer>
  <Balance>1</Balance>
  <SpecificBalance>1</SpecificBalance>
  <Blocked>False</Blocked>
  <EmailAddress />
  <GeocallCLI>+1234567890</GeocallCLI>
</GetUserInfo>
2026-01-07 22:38:10 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType11`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType12`6[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-07 22:38:10 [INF] Executed action VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API) in 183.4808ms
2026-01-07 22:38:10 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:38:10 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:38:10 [INF] CORS policy execution successful.
2026-01-07 22:38:10 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 200 null application/json; charset=utf-8 204.2757ms
2026-01-07 22:38:10 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:38:10 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/calls/external - null null
2026-01-07 22:38:10 [INF] Route matched with {action = "GetMe", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller VoIPPlatform.API.Controllers.AuthController (VoIPPlatform.API).
2026-01-07 22:38:10 [INF] CORS policy execution successful.
2026-01-07 22:38:10 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/calls/external - 204 null null 11.7288ms
2026-01-07 22:38:10 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Username] = @__username_0
2026-01-07 22:38:10 [INF] Request starting HTTP/2 GET https://localhost:7257/api/calls/external - null null
2026-01-07 22:38:10 [INF] Start processing HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:38:10 [INF] CORS policy execution successful.
2026-01-07 22:38:10 [INF] Sending HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:38:10 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.CallsController.GetCallsExternal (VoIPPlatform.API)'
2026-01-07 22:38:10 [INF] Route matched with {action = "GetCallsExternal", controller = "Calls"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCallsExternal(System.String, System.String) on controller VoIPPlatform.API.Controllers.CallsController (VoIPPlatform.API).
2026-01-07 22:38:10 [INF] Start processing HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=calloverview&username=prov*sy&password=Prov@123456&customer=TestUser02&customerpassword=123456&direction=backward&recordcount=50
2026-01-07 22:38:10 [INF] Sending HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=calloverview&username=prov*sy&password=Prov@123456&customer=TestUser02&customerpassword=123456&direction=backward&recordcount=50
2026-01-07 22:38:10 [INF] Received HTTP response headers after 61.9799ms - 200
2026-01-07 22:38:10 [INF] End processing HTTP request after 70.0308ms - 200
2026-01-07 22:38:10 [INF] GetUserInfo Response: <?xml version="1.0"?>
<!DOCTYPE GetUserInfo>
<GetUserInfo>
  <Customer>TestUser02*prov</Customer>
  <Balance>1</Balance>
  <SpecificBalance>1</SpecificBalance>
  <Blocked>False</Blocked>
  <EmailAddress />
  <GeocallCLI>+1234567890</GeocallCLI>
</GetUserInfo>
2026-01-07 22:38:10 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType11`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType12`6[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-07 22:38:10 [INF] Executed action VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API) in 88.2614ms
2026-01-07 22:38:10 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:38:10 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:38:10 [INF] CORS policy execution successful.
2026-01-07 22:38:10 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 200 null application/json; charset=utf-8 116.7258ms
2026-01-07 22:38:10 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:38:10 [INF] Route matched with {action = "GetMe", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller VoIPPlatform.API.Controllers.AuthController (VoIPPlatform.API).
2026-01-07 22:38:10 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Username] = @__username_0
2026-01-07 22:38:10 [INF] Start processing HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:38:10 [INF] Sending HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:38:10 [INF] Received HTTP response headers after 117.1808ms - 200
2026-01-07 22:38:10 [INF] End processing HTTP request after 123.2032ms - 200
2026-01-07 22:38:10 [INF] CallOverview Response: <?xml version="1.0"?>
<!DOCTYPE CallOverview>
<CallOverview>
  <Calls Count="0" />
  <MoreData>False</MoreData>
</CallOverview>
2026-01-07 22:38:10 [INF] Received HTTP response headers after 59.9271ms - 200
2026-01-07 22:38:10 [INF] End processing HTTP request after 65.3466ms - 200
2026-01-07 22:38:10 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[VoIPPlatform.API.Services.ExternalCallRecord, VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-01-07 22:38:10 [INF] GetUserInfo Response: <?xml version="1.0"?>
<!DOCTYPE GetUserInfo>
<GetUserInfo>
  <Customer>TestUser02*prov</Customer>
  <Balance>1</Balance>
  <SpecificBalance>1</SpecificBalance>
  <Blocked>False</Blocked>
  <EmailAddress />
  <GeocallCLI>+1234567890</GeocallCLI>
</GetUserInfo>
2026-01-07 22:38:10 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType11`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType12`6[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-07 22:38:10 [INF] Executed action VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API) in 79.3227ms
2026-01-07 22:38:10 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:38:10 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 200 null application/json; charset=utf-8 100.7884ms
2026-01-07 22:38:10 [INF] Executed action VoIPPlatform.API.Controllers.CallsController.GetCallsExternal (VoIPPlatform.API) in 162.9324ms
2026-01-07 22:38:10 [INF] Request starting HTTP/2 GET https://localhost:7257/api/calls/external - null null
2026-01-07 22:38:10 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.CallsController.GetCallsExternal (VoIPPlatform.API)'
2026-01-07 22:38:10 [INF] CORS policy execution successful.
2026-01-07 22:38:10 [INF] Request finished HTTP/2 GET https://localhost:7257/api/calls/external - 200 null application/json; charset=utf-8 202.1908ms
2026-01-07 22:38:10 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.CallsController.GetCallsExternal (VoIPPlatform.API)'
2026-01-07 22:38:10 [INF] Route matched with {action = "GetCallsExternal", controller = "Calls"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCallsExternal(System.String, System.String) on controller VoIPPlatform.API.Controllers.CallsController (VoIPPlatform.API).
2026-01-07 22:38:10 [INF] Start processing HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=calloverview&username=prov*sy&password=Prov@123456&customer=TestUser02&customerpassword=123456&direction=backward&recordcount=50
2026-01-07 22:38:10 [INF] Sending HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=calloverview&username=prov*sy&password=Prov@123456&customer=TestUser02&customerpassword=123456&direction=backward&recordcount=50
2026-01-07 22:38:10 [INF] Received HTTP response headers after 88.3582ms - 200
2026-01-07 22:38:10 [INF] End processing HTTP request after 108.9749ms - 200
2026-01-07 22:38:10 [INF] CallOverview Response: <?xml version="1.0"?>
<!DOCTYPE CallOverview>
<CallOverview>
  <Calls Count="0" />
  <MoreData>False</MoreData>
</CallOverview>
2026-01-07 22:38:10 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[VoIPPlatform.API.Services.ExternalCallRecord, VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-01-07 22:38:10 [INF] Executed action VoIPPlatform.API.Controllers.CallsController.GetCallsExternal (VoIPPlatform.API) in 128.9893ms
2026-01-07 22:38:10 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.CallsController.GetCallsExternal (VoIPPlatform.API)'
2026-01-07 22:38:10 [INF] Request finished HTTP/2 GET https://localhost:7257/api/calls/external - 200 null application/json; charset=utf-8 150.7302ms
2026-01-07 22:38:40 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - null null
2026-01-07 22:38:40 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/SMS - null null
2026-01-07 22:38:40 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - null null
2026-01-07 22:38:40 [INF] CORS policy execution successful.
2026-01-07 22:38:40 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/SMS - null null
2026-01-07 22:38:40 [INF] CORS policy execution successful.
2026-01-07 22:38:40 [INF] CORS policy execution successful.
2026-01-07 22:38:40 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - 204 null null 11.6877ms
2026-01-07 22:38:40 [INF] CORS policy execution successful.
2026-01-07 22:38:40 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/SMS - 204 null null 14.6768ms
2026-01-07 22:38:40 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - 204 null null 13.7013ms
2026-01-07 22:38:40 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/SMS - 204 null null 16.9629ms
2026-01-07 22:38:40 [INF] Request starting HTTP/2 GET https://localhost:7257/api/SMS - null null
2026-01-07 22:38:40 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:38:40 [INF] CORS policy execution successful.
2026-01-07 22:38:40 [INF] CORS policy execution successful.
2026-01-07 22:38:40 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:38:40 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:38:40 [INF] Route matched with {action = "GetMe", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller VoIPPlatform.API.Controllers.AuthController (VoIPPlatform.API).
2026-01-07 22:38:40 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Username] = @__username_0
2026-01-07 22:38:40 [INF] Start processing HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:38:40 [INF] Sending HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:38:40 [INF] Received HTTP response headers after 64.3013ms - 200
2026-01-07 22:38:40 [INF] End processing HTTP request after 69.5141ms - 200
2026-01-07 22:38:40 [INF] GetUserInfo Response: <?xml version="1.0"?>
<!DOCTYPE GetUserInfo>
<GetUserInfo>
  <Customer>TestUser02*prov</Customer>
  <Balance>1</Balance>
  <SpecificBalance>1</SpecificBalance>
  <Blocked>False</Blocked>
  <EmailAddress />
  <GeocallCLI>+1234567890</GeocallCLI>
</GetUserInfo>
2026-01-07 22:38:40 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType11`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType12`6[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-07 22:38:40 [INF] Executed action VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API) in 83.1257ms
2026-01-07 22:38:40 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:38:40 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:38:40 [INF] CORS policy execution successful.
2026-01-07 22:38:40 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 200 null application/json; charset=utf-8 110.61ms
2026-01-07 22:38:40 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:38:40 [INF] Route matched with {action = "GetMe", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller VoIPPlatform.API.Controllers.AuthController (VoIPPlatform.API).
2026-01-07 22:38:40 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Username] = @__username_0
2026-01-07 22:38:40 [INF] Start processing HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:38:40 [INF] Sending HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:38:40 [INF] Received HTTP response headers after 58.7985ms - 200
2026-01-07 22:38:40 [INF] End processing HTTP request after 63.7176ms - 200
2026-01-07 22:38:40 [INF] GetUserInfo Response: <?xml version="1.0"?>
<!DOCTYPE GetUserInfo>
<GetUserInfo>
  <Customer>TestUser02*prov</Customer>
  <Balance>1</Balance>
  <SpecificBalance>1</SpecificBalance>
  <Blocked>False</Blocked>
  <EmailAddress />
  <GeocallCLI>+1234567890</GeocallCLI>
</GetUserInfo>
2026-01-07 22:38:40 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType11`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType12`6[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-07 22:38:40 [INF] Executed action VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API) in 75.583ms
2026-01-07 22:38:40 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:38:40 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 200 null application/json; charset=utf-8 92.4987ms
2026-01-07 22:38:42 [INF] Route matched with {action = "GetAllSMS", controller = "SMS"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllSMS() on controller VoIPPlatform.API.Controllers.SMSController (VoIPPlatform.API).
2026-01-07 22:38:42 [INF] Fetching all SMS
2026-01-07 22:38:43 [INF] Executed DbCommand (77ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AccountId], [s].[UserId], [a].[VirtualPhoneNumber] AS [AccountNumber], [u].[FirstName] + N' ' + [u].[LastName] AS [UserName], [s].[SenderNumber], [s].[RecipientNumber], [s].[MessageContent], [s].[MessageLength], [s].[Cost], [s].[Status], [s].[CreatedAt], [s].[SentAt], [s].[ErrorMessage]
FROM [SMS] AS [s]
INNER JOIN [Accounts] AS [a] ON [s].[AccountId] = [a].[Id]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
2026-01-07 22:38:43 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType25`14[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-01-07 22:38:43 [INF] Executed action VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API) in 1072.9904ms
2026-01-07 22:38:43 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:38:43 [INF] Request finished HTTP/2 GET https://localhost:7257/api/SMS - 200 null application/json; charset=utf-8 2812.296ms
2026-01-07 22:38:43 [INF] Request starting HTTP/2 GET https://localhost:7257/api/SMS - null null
2026-01-07 22:38:43 [INF] CORS policy execution successful.
2026-01-07 22:38:43 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:38:43 [INF] Route matched with {action = "GetAllSMS", controller = "SMS"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllSMS() on controller VoIPPlatform.API.Controllers.SMSController (VoIPPlatform.API).
2026-01-07 22:38:43 [INF] Fetching all SMS
2026-01-07 22:38:43 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AccountId], [s].[UserId], [a].[VirtualPhoneNumber] AS [AccountNumber], [u].[FirstName] + N' ' + [u].[LastName] AS [UserName], [s].[SenderNumber], [s].[RecipientNumber], [s].[MessageContent], [s].[MessageLength], [s].[Cost], [s].[Status], [s].[CreatedAt], [s].[SentAt], [s].[ErrorMessage]
FROM [SMS] AS [s]
INNER JOIN [Accounts] AS [a] ON [s].[AccountId] = [a].[Id]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
2026-01-07 22:38:43 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType25`14[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-01-07 22:38:43 [INF] Executed action VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API) in 19.0267ms
2026-01-07 22:38:43 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:38:43 [INF] Request finished HTTP/2 GET https://localhost:7257/api/SMS - 200 null application/json; charset=utf-8 37.9996ms
2026-01-07 22:39:36 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/SMS - null null
2026-01-07 22:39:36 [INF] CORS policy execution successful.
2026-01-07 22:39:36 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/SMS - 204 null null 6.4113ms
2026-01-07 22:39:36 [INF] Request starting HTTP/2 POST https://localhost:7257/api/SMS - application/json 115
2026-01-07 22:39:36 [INF] CORS policy execution successful.
2026-01-07 22:39:36 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API)'
2026-01-07 22:39:36 [INF] Route matched with {action = "SendSMS", controller = "SMS"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendSMS(SendSMSRequest) on controller VoIPPlatform.API.Controllers.SMSController (VoIPPlatform.API).
2026-01-07 22:39:36 [INF] Processing SendSMS Request [VERSION 2]. UserId: 34, AccountId: 34
2026-01-07 22:39:36 [INF] Executed DbCommand (30ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2026-01-07 22:39:36 [INF] Executed DbCommand (30ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccountType], [a].[Balance], [a].[CountryCode], [a].[CreatedAt], [a].[DeactivatedAt], [a].[IsActive], [a].[MonthlyUsage], [a].[RenewsAt], [a].[UserId], [a].[VirtualPhoneNumber]
FROM [Accounts] AS [a]
WHERE [a].[UserId] = @__request_UserId_0
2026-01-07 22:39:36 [INF] Sending SMS from 1234567890 to +46707524770 for account 34
2026-01-07 22:39:36 [INF] Sending SMS to +46707524770 from 1234567890
2026-01-07 22:39:36 [INF] Start processing HTTP request GET https://www.voicetrading.com/myaccount/sendsms.php?username=reninvoip1&password=NaTale1961&from=1234567890&to=%2B46707524770&text=H%20San%21
2026-01-07 22:39:36 [INF] Sending HTTP request GET https://www.voicetrading.com/myaccount/sendsms.php?username=reninvoip1&password=NaTale1961&from=1234567890&to=%2B46707524770&text=H%20San%21
2026-01-07 22:39:56 [INF] Received HTTP response headers after 20384.378ms - 200
2026-01-07 22:39:56 [INF] End processing HTTP request after 20390.2503ms - 200
2026-01-07 22:39:56 [INF] SMS sent successfully (XML Format). Response: <?xml version="1.0" encoding="utf-8"?> 
<SmsResponse>
    <version>1</version>
    <result>1</result> 
    <resultstring>success</resultstring>
    <description></description>
    <partcount>1</partcount>
    <endcause></endcause>
    <browserID>0</browserID>
    <lsID>none</lsID>
    <sessionkey>d3tb62e3r6183qfc46anf60gib</sessionkey>
    <campaignID></campaignID>
</SmsResponse>
2026-01-07 22:39:57 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2026-01-07 22:39:57 [INF] Executed DbCommand (258ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = DateTime2), @p6='?' (Size = 500), @p7='?' (Size = 100), @p8='?' (Size = 1000), @p9='?' (DbType = Int32), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = DateTime2), @p13='?' (Size = 50), @p14='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Balance] = @p0, [MonthlyUsage] = @p1
OUTPUT 1
WHERE [Id] = @p2;
INSERT INTO [SMS] ([AccountId], [Cost], [CreatedAt], [ErrorMessage], [ExternalId], [MessageContent], [MessageLength], [RecipientNumber], [SenderNumber], [SentAt], [Status], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2026-01-07 22:39:57 [ERR] An exception occurred in the database while saving changes for context type 'VoIPPlatform.API.Models.VoIPDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:afd25e4d-4cd1-4c81-9bf0-253b66c82b7a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:afd25e4d-4cd1-4c81-9bf0-253b66c82b7a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2026-01-07 22:39:57 [ERR] Error sending SMS
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:afd25e4d-4cd1-4c81-9bf0-253b66c82b7a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 242
2026-01-07 22:39:57 [ERR] Unexpected error in SendSMS.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:afd25e4d-4cd1-4c81-9bf0-253b66c82b7a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 242
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 316
2026-01-07 22:39:57 [INF] Executed action VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API) in 21819.8305ms
2026-01-07 22:39:57 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API)'
2026-01-07 22:39:58 [INF] Request finished HTTP/2 POST https://localhost:7257/api/SMS - 500 null application/json; charset=utf-8 21861.0984ms
2026-01-07 22:40:15 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/SMS - null null
2026-01-07 22:40:15 [INF] CORS policy execution successful.
2026-01-07 22:40:15 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/SMS - 204 null null 6.1735ms
2026-01-07 22:40:15 [INF] Request starting HTTP/2 GET https://localhost:7257/api/SMS - null null
2026-01-07 22:40:15 [INF] CORS policy execution successful.
2026-01-07 22:40:15 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:40:15 [INF] Route matched with {action = "GetAllSMS", controller = "SMS"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllSMS() on controller VoIPPlatform.API.Controllers.SMSController (VoIPPlatform.API).
2026-01-07 22:40:15 [INF] Fetching all SMS
2026-01-07 22:40:15 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AccountId], [s].[UserId], [a].[VirtualPhoneNumber] AS [AccountNumber], [u].[FirstName] + N' ' + [u].[LastName] AS [UserName], [s].[SenderNumber], [s].[RecipientNumber], [s].[MessageContent], [s].[MessageLength], [s].[Cost], [s].[Status], [s].[CreatedAt], [s].[SentAt], [s].[ErrorMessage]
FROM [SMS] AS [s]
INNER JOIN [Accounts] AS [a] ON [s].[AccountId] = [a].[Id]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
2026-01-07 22:40:15 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType25`14[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-01-07 22:40:15 [INF] Executed action VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API) in 11.6748ms
2026-01-07 22:40:15 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:40:15 [INF] Request finished HTTP/2 GET https://localhost:7257/api/SMS - 200 null application/json; charset=utf-8 28.7218ms
2026-01-07 22:40:15 [INF] Request starting HTTP/2 GET https://localhost:7257/api/SMS - null null
2026-01-07 22:40:16 [INF] CORS policy execution successful.
2026-01-07 22:40:16 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:40:16 [INF] Route matched with {action = "GetAllSMS", controller = "SMS"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllSMS() on controller VoIPPlatform.API.Controllers.SMSController (VoIPPlatform.API).
2026-01-07 22:40:16 [INF] Fetching all SMS
2026-01-07 22:40:16 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AccountId], [s].[UserId], [a].[VirtualPhoneNumber] AS [AccountNumber], [u].[FirstName] + N' ' + [u].[LastName] AS [UserName], [s].[SenderNumber], [s].[RecipientNumber], [s].[MessageContent], [s].[MessageLength], [s].[Cost], [s].[Status], [s].[CreatedAt], [s].[SentAt], [s].[ErrorMessage]
FROM [SMS] AS [s]
INNER JOIN [Accounts] AS [a] ON [s].[AccountId] = [a].[Id]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
2026-01-07 22:40:16 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType25`14[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-01-07 22:40:16 [INF] Executed action VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API) in 15.6315ms
2026-01-07 22:40:16 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:40:16 [INF] Request finished HTTP/2 GET https://localhost:7257/api/SMS - 200 null application/json; charset=utf-8 31.1786ms
2026-01-07 22:40:21 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/SMS - null null
2026-01-07 22:40:21 [INF] CORS policy execution successful.
2026-01-07 22:40:21 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/SMS - 204 null null 7.0653ms
2026-01-07 22:40:21 [INF] Request starting HTTP/2 POST https://localhost:7257/api/SMS - application/json 115
2026-01-07 22:40:21 [INF] CORS policy execution successful.
2026-01-07 22:40:21 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API)'
2026-01-07 22:40:21 [INF] Route matched with {action = "SendSMS", controller = "SMS"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendSMS(SendSMSRequest) on controller VoIPPlatform.API.Controllers.SMSController (VoIPPlatform.API).
2026-01-07 22:40:21 [INF] Processing SendSMS Request [VERSION 2]. UserId: 34, AccountId: 34
2026-01-07 22:40:21 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2026-01-07 22:40:21 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccountType], [a].[Balance], [a].[CountryCode], [a].[CreatedAt], [a].[DeactivatedAt], [a].[IsActive], [a].[MonthlyUsage], [a].[RenewsAt], [a].[UserId], [a].[VirtualPhoneNumber]
FROM [Accounts] AS [a]
WHERE [a].[UserId] = @__request_UserId_0
2026-01-07 22:40:21 [INF] Sending SMS from 1234567890 to +46707524770 for account 34
2026-01-07 22:40:21 [INF] Sending SMS to +46707524770 from 1234567890
2026-01-07 22:40:21 [INF] Start processing HTTP request GET https://www.voicetrading.com/myaccount/sendsms.php?username=reninvoip1&password=NaTale1961&from=1234567890&to=%2B46707524770&text=H%20San%21
2026-01-07 22:40:21 [INF] Sending HTTP request GET https://www.voicetrading.com/myaccount/sendsms.php?username=reninvoip1&password=NaTale1961&from=1234567890&to=%2B46707524770&text=H%20San%21
2026-01-07 22:40:41 [INF] Received HTTP response headers after 20307.7891ms - 200
2026-01-07 22:40:41 [INF] End processing HTTP request after 20312.7827ms - 200
2026-01-07 22:40:41 [INF] SMS sent successfully (XML Format). Response: <?xml version="1.0" encoding="utf-8"?> 
<SmsResponse>
    <version>1</version>
    <result>1</result> 
    <resultstring>success</resultstring>
    <description></description>
    <partcount>1</partcount>
    <endcause></endcause>
    <browserID>0</browserID>
    <lsID>none</lsID>
    <sessionkey>mklppdnhv70pt82ndh749bu291</sessionkey>
    <campaignID></campaignID>
</SmsResponse>
2026-01-07 22:40:41 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2026-01-07 22:40:41 [INF] Executed DbCommand (1ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = DateTime2), @p6='?' (Size = 500), @p7='?' (Size = 100), @p8='?' (Size = 1000), @p9='?' (DbType = Int32), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = DateTime2), @p13='?' (Size = 50), @p14='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Balance] = @p0, [MonthlyUsage] = @p1
OUTPUT 1
WHERE [Id] = @p2;
INSERT INTO [SMS] ([AccountId], [Cost], [CreatedAt], [ErrorMessage], [ExternalId], [MessageContent], [MessageLength], [RecipientNumber], [SenderNumber], [SentAt], [Status], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2026-01-07 22:40:41 [ERR] An exception occurred in the database while saving changes for context type 'VoIPPlatform.API.Models.VoIPDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:afd25e4d-4cd1-4c81-9bf0-253b66c82b7a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:afd25e4d-4cd1-4c81-9bf0-253b66c82b7a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2026-01-07 22:40:42 [ERR] Error sending SMS
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:afd25e4d-4cd1-4c81-9bf0-253b66c82b7a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 242
2026-01-07 22:40:42 [ERR] Unexpected error in SendSMS.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:afd25e4d-4cd1-4c81-9bf0-253b66c82b7a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 242
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 316
2026-01-07 22:40:42 [INF] Executed action VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API) in 20401.5302ms
2026-01-07 22:40:42 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API)'
2026-01-07 22:40:42 [INF] Request finished HTTP/2 POST https://localhost:7257/api/SMS - 500 null application/json; charset=utf-8 20415.6298ms
2026-01-07 22:41:14 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/SMS - null null
2026-01-07 22:41:14 [INF] CORS policy execution successful.
2026-01-07 22:41:14 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/SMS - 204 null null 7.3083ms
2026-01-07 22:41:14 [INF] Request starting HTTP/2 POST https://localhost:7257/api/SMS - application/json 115
2026-01-07 22:41:14 [INF] CORS policy execution successful.
2026-01-07 22:41:14 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API)'
2026-01-07 22:41:14 [INF] Route matched with {action = "SendSMS", controller = "SMS"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendSMS(SendSMSRequest) on controller VoIPPlatform.API.Controllers.SMSController (VoIPPlatform.API).
2026-01-07 22:41:14 [INF] Processing SendSMS Request [VERSION 2]. UserId: 34, AccountId: 34
2026-01-07 22:41:14 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2026-01-07 22:41:14 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccountType], [a].[Balance], [a].[CountryCode], [a].[CreatedAt], [a].[DeactivatedAt], [a].[IsActive], [a].[MonthlyUsage], [a].[RenewsAt], [a].[UserId], [a].[VirtualPhoneNumber]
FROM [Accounts] AS [a]
WHERE [a].[UserId] = @__request_UserId_0
2026-01-07 22:41:14 [INF] Sending SMS from 1234567890 to +46707524770 for account 34
2026-01-07 22:41:14 [INF] Sending SMS to +46707524770 from 1234567890
2026-01-07 22:41:14 [INF] Start processing HTTP request GET https://www.voicetrading.com/myaccount/sendsms.php?username=reninvoip1&password=NaTale1961&from=1234567890&to=%2B46707524770&text=H%20San%21
2026-01-07 22:41:14 [INF] Sending HTTP request GET https://www.voicetrading.com/myaccount/sendsms.php?username=reninvoip1&password=NaTale1961&from=1234567890&to=%2B46707524770&text=H%20San%21
2026-01-07 22:41:35 [INF] Received HTTP response headers after 20319.802ms - 200
2026-01-07 22:41:35 [INF] End processing HTTP request after 20325.3581ms - 200
2026-01-07 22:41:35 [INF] SMS sent successfully (XML Format). Response: <?xml version="1.0" encoding="utf-8"?> 
<SmsResponse>
    <version>1</version>
    <result>1</result> 
    <resultstring>success</resultstring>
    <description></description>
    <partcount>1</partcount>
    <endcause></endcause>
    <browserID>0</browserID>
    <lsID>none</lsID>
    <sessionkey>eee4jhhk3mu1130m0avbfdnb7l</sessionkey>
    <campaignID></campaignID>
</SmsResponse>
2026-01-07 22:41:35 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2026-01-07 22:41:35 [INF] Executed DbCommand (2ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = DateTime2), @p6='?' (Size = 500), @p7='?' (Size = 100), @p8='?' (Size = 1000), @p9='?' (DbType = Int32), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = DateTime2), @p13='?' (Size = 50), @p14='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Balance] = @p0, [MonthlyUsage] = @p1
OUTPUT 1
WHERE [Id] = @p2;
INSERT INTO [SMS] ([AccountId], [Cost], [CreatedAt], [ErrorMessage], [ExternalId], [MessageContent], [MessageLength], [RecipientNumber], [SenderNumber], [SentAt], [Status], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2026-01-07 22:41:35 [ERR] An exception occurred in the database while saving changes for context type 'VoIPPlatform.API.Models.VoIPDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:afd25e4d-4cd1-4c81-9bf0-253b66c82b7a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:afd25e4d-4cd1-4c81-9bf0-253b66c82b7a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2026-01-07 22:41:35 [ERR] Error sending SMS
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:afd25e4d-4cd1-4c81-9bf0-253b66c82b7a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 242
2026-01-07 22:41:35 [ERR] Unexpected error in SendSMS.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:afd25e4d-4cd1-4c81-9bf0-253b66c82b7a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 242
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 316
2026-01-07 22:41:35 [INF] Executed action VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API) in 20413.0924ms
2026-01-07 22:41:35 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API)'
2026-01-07 22:41:35 [INF] Request finished HTTP/2 POST https://localhost:7257/api/SMS - 500 null application/json; charset=utf-8 20428.7233ms
2026-01-07 22:47:45 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - null null
2026-01-07 22:47:45 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/SMS - null null
2026-01-07 22:47:45 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - null null
2026-01-07 22:47:45 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/SMS - null null
2026-01-07 22:47:45 [INF] CORS policy execution successful.
2026-01-07 22:47:45 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/SMS - 204 null null 20.7068ms
2026-01-07 22:47:45 [INF] CORS policy execution successful.
2026-01-07 22:47:45 [INF] CORS policy execution successful.
2026-01-07 22:47:45 [INF] CORS policy execution successful.
2026-01-07 22:47:45 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/SMS - 204 null null 38.5727ms
2026-01-07 22:47:45 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - 204 null null 50.6431ms
2026-01-07 22:47:45 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - 204 null null 33.5034ms
2026-01-07 22:47:45 [INF] Request starting HTTP/2 GET https://localhost:7257/api/SMS - null null
2026-01-07 22:47:45 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:47:45 [INF] CORS policy execution successful.
2026-01-07 22:47:45 [INF] CORS policy execution successful.
2026-01-07 22:47:45 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:47:45 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:47:45 [INF] Route matched with {action = "GetAllSMS", controller = "SMS"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllSMS() on controller VoIPPlatform.API.Controllers.SMSController (VoIPPlatform.API).
2026-01-07 22:47:45 [INF] Route matched with {action = "GetMe", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller VoIPPlatform.API.Controllers.AuthController (VoIPPlatform.API).
2026-01-07 22:47:45 [INF] Fetching all SMS
2026-01-07 22:47:45 [INF] Executed DbCommand (43ms) [Parameters=[@__username_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Username] = @__username_0
2026-01-07 22:47:45 [INF] Executed DbCommand (39ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AccountId], [s].[UserId], [a].[VirtualPhoneNumber] AS [AccountNumber], [u].[FirstName] + N' ' + [u].[LastName] AS [UserName], [s].[SenderNumber], [s].[RecipientNumber], [s].[MessageContent], [s].[MessageLength], [s].[Cost], [s].[Status], [s].[CreatedAt], [s].[SentAt], [s].[ErrorMessage]
FROM [SMS] AS [s]
INNER JOIN [Accounts] AS [a] ON [s].[AccountId] = [a].[Id]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
2026-01-07 22:47:45 [INF] Start processing HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:47:45 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType25`14[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-01-07 22:47:45 [INF] Sending HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:47:45 [INF] Executed action VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API) in 466.8794ms
2026-01-07 22:47:45 [INF] Request starting HTTP/2 GET https://localhost:7257/api/SMS - null null
2026-01-07 22:47:45 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:47:45 [INF] CORS policy execution successful.
2026-01-07 22:47:45 [INF] Request finished HTTP/2 GET https://localhost:7257/api/SMS - 200 null application/json; charset=utf-8 496.6594ms
2026-01-07 22:47:45 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:47:45 [INF] Route matched with {action = "GetAllSMS", controller = "SMS"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllSMS() on controller VoIPPlatform.API.Controllers.SMSController (VoIPPlatform.API).
2026-01-07 22:47:45 [INF] Fetching all SMS
2026-01-07 22:47:45 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AccountId], [s].[UserId], [a].[VirtualPhoneNumber] AS [AccountNumber], [u].[FirstName] + N' ' + [u].[LastName] AS [UserName], [s].[SenderNumber], [s].[RecipientNumber], [s].[MessageContent], [s].[MessageLength], [s].[Cost], [s].[Status], [s].[CreatedAt], [s].[SentAt], [s].[ErrorMessage]
FROM [SMS] AS [s]
INNER JOIN [Accounts] AS [a] ON [s].[AccountId] = [a].[Id]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
2026-01-07 22:47:45 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType25`14[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-01-07 22:47:45 [INF] Executed action VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API) in 17.4741ms
2026-01-07 22:47:45 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:47:45 [INF] Request finished HTTP/2 GET https://localhost:7257/api/SMS - 200 null application/json; charset=utf-8 43.221ms
2026-01-07 22:47:45 [INF] Received HTTP response headers after 144.4648ms - 200
2026-01-07 22:47:45 [INF] End processing HTTP request after 160.9272ms - 200
2026-01-07 22:47:45 [INF] GetUserInfo Response: <?xml version="1.0"?>
<!DOCTYPE GetUserInfo>
<GetUserInfo>
  <Customer>TestUser02*prov</Customer>
  <Balance>1</Balance>
  <SpecificBalance>1</SpecificBalance>
  <Blocked>False</Blocked>
  <EmailAddress />
  <GeocallCLI>+1234567890</GeocallCLI>
</GetUserInfo>
2026-01-07 22:47:45 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType11`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType12`6[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-07 22:47:45 [INF] Executed action VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API) in 653.2707ms
2026-01-07 22:47:45 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:47:45 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:47:45 [INF] CORS policy execution successful.
2026-01-07 22:47:45 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 200 null application/json; charset=utf-8 685.0712ms
2026-01-07 22:47:45 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:47:45 [INF] Route matched with {action = "GetMe", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller VoIPPlatform.API.Controllers.AuthController (VoIPPlatform.API).
2026-01-07 22:47:45 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Username] = @__username_0
2026-01-07 22:47:45 [INF] Start processing HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:47:45 [INF] Sending HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:47:45 [INF] Received HTTP response headers after 66.9689ms - 200
2026-01-07 22:47:45 [INF] End processing HTTP request after 71.8257ms - 200
2026-01-07 22:47:45 [INF] GetUserInfo Response: <?xml version="1.0"?>
<!DOCTYPE GetUserInfo>
<GetUserInfo>
  <Customer>TestUser02*prov</Customer>
  <Balance>1</Balance>
  <SpecificBalance>1</SpecificBalance>
  <Blocked>False</Blocked>
  <EmailAddress />
  <GeocallCLI>+1234567890</GeocallCLI>
</GetUserInfo>
2026-01-07 22:47:45 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType11`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType12`6[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-07 22:47:45 [INF] Executed action VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API) in 84.3424ms
2026-01-07 22:47:45 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:47:45 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 200 null application/json; charset=utf-8 102.7014ms
2026-01-07 22:48:39 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/SMS - null null
2026-01-07 22:48:39 [INF] CORS policy execution successful.
2026-01-07 22:48:39 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/SMS - 204 null null 7.5589ms
2026-01-07 22:48:39 [INF] Request starting HTTP/2 POST https://localhost:7257/api/SMS - application/json 128
2026-01-07 22:48:39 [INF] CORS policy execution successful.
2026-01-07 22:48:39 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API)'
2026-01-07 22:48:39 [INF] Route matched with {action = "SendSMS", controller = "SMS"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendSMS(SendSMSRequest) on controller VoIPPlatform.API.Controllers.SMSController (VoIPPlatform.API).
2026-01-07 22:48:39 [INF] Processing SendSMS Request [VERSION 2]. UserId: 34, AccountId: 34
2026-01-07 22:48:39 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2026-01-07 22:48:39 [INF] Executed DbCommand (3ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccountType], [a].[Balance], [a].[CountryCode], [a].[CreatedAt], [a].[DeactivatedAt], [a].[IsActive], [a].[MonthlyUsage], [a].[RenewsAt], [a].[UserId], [a].[VirtualPhoneNumber]
FROM [Accounts] AS [a]
WHERE [a].[UserId] = @__request_UserId_0
2026-01-07 22:48:39 [INF] Sending SMS from 1234567890 to +46707524770 for account 34
2026-01-07 22:48:39 [INF] Sending SMS to +46707524770 from 1234567890
2026-01-07 22:48:39 [INF] Start processing HTTP request GET https://www.voicetrading.com/myaccount/sendsms.php?username=reninvoip1&password=NaTale1961&from=1234567890&to=%2B46707524770&text=Hi%20San%20Hur%20m%C3%A5r%20du%3F
2026-01-07 22:48:39 [INF] Sending HTTP request GET https://www.voicetrading.com/myaccount/sendsms.php?username=reninvoip1&password=NaTale1961&from=1234567890&to=%2B46707524770&text=Hi%20San%20Hur%20m%C3%A5r%20du%3F
2026-01-07 22:48:59 [INF] Received HTTP response headers after 20232.0649ms - 200
2026-01-07 22:48:59 [INF] End processing HTTP request after 20238.8239ms - 200
2026-01-07 22:48:59 [INF] SMS sent successfully (XML Format). Response: <?xml version="1.0" encoding="utf-8"?> 
<SmsResponse>
    <version>1</version>
    <result>1</result> 
    <resultstring>success</resultstring>
    <description></description>
    <partcount>1</partcount>
    <endcause></endcause>
    <browserID>0</browserID>
    <lsID>none</lsID>
    <sessionkey>8iplr5p9r55crkhaf7em9k7nl4</sessionkey>
    <campaignID></campaignID>
</SmsResponse>
2026-01-07 22:48:59 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2026-01-07 22:48:59 [INF] Executed DbCommand (155ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = DateTime2), @p6='?' (Size = 500), @p7='?' (Size = 100), @p8='?' (Size = 1000), @p9='?' (DbType = Int32), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = DateTime2), @p13='?' (Size = 50), @p14='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Balance] = @p0, [MonthlyUsage] = @p1
OUTPUT 1
WHERE [Id] = @p2;
INSERT INTO [SMS] ([AccountId], [Cost], [CreatedAt], [ErrorMessage], [ExternalId], [MessageContent], [MessageLength], [RecipientNumber], [SenderNumber], [SentAt], [Status], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2026-01-07 22:48:59 [ERR] An exception occurred in the database while saving changes for context type 'VoIPPlatform.API.Models.VoIPDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2795b368-8466-48dc-8ec5-051fc67c7cde
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2795b368-8466-48dc-8ec5-051fc67c7cde
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2026-01-07 22:48:59 [ERR] Error sending SMS
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2795b368-8466-48dc-8ec5-051fc67c7cde
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 242
2026-01-07 22:48:59 [ERR] Unexpected error in SendSMS.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:2795b368-8466-48dc-8ec5-051fc67c7cde
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 242
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 316
2026-01-07 22:48:59 [INF] Executed action VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API) in 20633.1249ms
2026-01-07 22:49:00 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API)'
2026-01-07 22:49:00 [INF] Request finished HTTP/2 POST https://localhost:7257/api/SMS - 500 null application/json; charset=utf-8 20649.2555ms
2026-01-07 22:51:17 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - null null
2026-01-07 22:51:17 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/SMS - null null
2026-01-07 22:51:18 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - null null
2026-01-07 22:51:18 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/SMS - null null
2026-01-07 22:51:18 [INF] CORS policy execution successful.
2026-01-07 22:51:18 [INF] CORS policy execution successful.
2026-01-07 22:51:18 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/SMS - 204 null null 135.969ms
2026-01-07 22:51:18 [INF] CORS policy execution successful.
2026-01-07 22:51:18 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - 204 null null 91.3423ms
2026-01-07 22:51:18 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/Auth/me - 204 null null 144.7763ms
2026-01-07 22:51:18 [INF] CORS policy execution successful.
2026-01-07 22:51:18 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/SMS - 204 null null 127.994ms
2026-01-07 22:51:18 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:51:18 [INF] Request starting HTTP/2 GET https://localhost:7257/api/SMS - null null
2026-01-07 22:51:18 [INF] CORS policy execution successful.
2026-01-07 22:51:18 [INF] CORS policy execution successful.
2026-01-07 22:51:18 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:51:18 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:51:18 [INF] Route matched with {action = "GetMe", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller VoIPPlatform.API.Controllers.AuthController (VoIPPlatform.API).
2026-01-07 22:51:18 [INF] Route matched with {action = "GetAllSMS", controller = "SMS"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllSMS() on controller VoIPPlatform.API.Controllers.SMSController (VoIPPlatform.API).
2026-01-07 22:51:18 [INF] Fetching all SMS
2026-01-07 22:51:18 [INF] Executed DbCommand (1ms) [Parameters=[@__username_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Username] = @__username_0
2026-01-07 22:51:18 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AccountId], [s].[UserId], [a].[VirtualPhoneNumber] AS [AccountNumber], [u].[FirstName] + N' ' + [u].[LastName] AS [UserName], [s].[SenderNumber], [s].[RecipientNumber], [s].[MessageContent], [s].[MessageLength], [s].[Cost], [s].[Status], [s].[CreatedAt], [s].[SentAt], [s].[ErrorMessage]
FROM [SMS] AS [s]
INNER JOIN [Accounts] AS [a] ON [s].[AccountId] = [a].[Id]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
2026-01-07 22:51:18 [INF] Start processing HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:51:18 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType25`14[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-01-07 22:51:18 [INF] Sending HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:51:18 [INF] Executed action VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API) in 17.4809ms
2026-01-07 22:51:18 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:51:18 [INF] Request starting HTTP/2 GET https://localhost:7257/api/SMS - null null
2026-01-07 22:51:18 [INF] Request finished HTTP/2 GET https://localhost:7257/api/SMS - 200 null application/json; charset=utf-8 188.4668ms
2026-01-07 22:51:18 [INF] CORS policy execution successful.
2026-01-07 22:51:18 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:51:18 [INF] Route matched with {action = "GetAllSMS", controller = "SMS"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllSMS() on controller VoIPPlatform.API.Controllers.SMSController (VoIPPlatform.API).
2026-01-07 22:51:18 [INF] Fetching all SMS
2026-01-07 22:51:18 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [s].[Id], [s].[AccountId], [s].[UserId], [a].[VirtualPhoneNumber] AS [AccountNumber], [u].[FirstName] + N' ' + [u].[LastName] AS [UserName], [s].[SenderNumber], [s].[RecipientNumber], [s].[MessageContent], [s].[MessageLength], [s].[Cost], [s].[Status], [s].[CreatedAt], [s].[SentAt], [s].[ErrorMessage]
FROM [SMS] AS [s]
INNER JOIN [Accounts] AS [a] ON [s].[AccountId] = [a].[Id]
INNER JOIN [Users] AS [u] ON [s].[UserId] = [u].[Id]
2026-01-07 22:51:18 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`4[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Collections.Generic.List`1[[<>f__AnonymousType25`14[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Nullable`1[[System.DateTime, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]], System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2026-01-07 22:51:18 [INF] Executed action VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API) in 57.3194ms
2026-01-07 22:51:18 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.SMSController.GetAllSMS (VoIPPlatform.API)'
2026-01-07 22:51:18 [INF] Request finished HTTP/2 GET https://localhost:7257/api/SMS - 200 null application/json; charset=utf-8 126.9703ms
2026-01-07 22:51:18 [INF] Received HTTP response headers after 229.3976ms - 200
2026-01-07 22:51:18 [INF] End processing HTTP request after 243.2247ms - 200
2026-01-07 22:51:18 [INF] GetUserInfo Response: <?xml version="1.0"?>
<!DOCTYPE GetUserInfo>
<GetUserInfo>
  <Customer>TestUser02*prov</Customer>
  <Balance>1</Balance>
  <SpecificBalance>1</SpecificBalance>
  <Blocked>False</Blocked>
  <EmailAddress />
  <GeocallCLI>+1234567890</GeocallCLI>
</GetUserInfo>
2026-01-07 22:51:18 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType11`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType12`6[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-07 22:51:18 [INF] Executed action VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API) in 259.3886ms
2026-01-07 22:51:18 [INF] Request starting HTTP/2 GET https://localhost:7257/api/Auth/me - null null
2026-01-07 22:51:18 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:51:18 [INF] CORS policy execution successful.
2026-01-07 22:51:18 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 200 null application/json; charset=utf-8 351.3125ms
2026-01-07 22:51:18 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:51:18 [INF] Route matched with {action = "GetMe", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetMe() on controller VoIPPlatform.API.Controllers.AuthController (VoIPPlatform.API).
2026-01-07 22:51:18 [INF] Executed DbCommand (7ms) [Parameters=[@__username_0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Username] = @__username_0
2026-01-07 22:51:18 [INF] Start processing HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:51:18 [INF] Sending HTTP request GET https://www.voipinfocenter.com/API/Request.ashx?command=getuserinfo&username=prov*sy&password=Prov@123456&customer=TestUser02
2026-01-07 22:51:18 [INF] Received HTTP response headers after 63.9314ms - 200
2026-01-07 22:51:18 [INF] End processing HTTP request after 68.7724ms - 200
2026-01-07 22:51:18 [INF] GetUserInfo Response: <?xml version="1.0"?>
<!DOCTYPE GetUserInfo>
<GetUserInfo>
  <Customer>TestUser02*prov</Customer>
  <Balance>1</Balance>
  <SpecificBalance>1</SpecificBalance>
  <Blocked>False</Blocked>
  <EmailAddress />
  <GeocallCLI>+1234567890</GeocallCLI>
</GetUserInfo>
2026-01-07 22:51:18 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType11`2[[System.Boolean, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[<>f__AnonymousType12`6[[System.Int32, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.Decimal, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e],[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]], VoIPPlatform.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2026-01-07 22:51:18 [INF] Executed action VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API) in 87.6242ms
2026-01-07 22:51:18 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.AuthController.GetMe (VoIPPlatform.API)'
2026-01-07 22:51:18 [INF] Request finished HTTP/2 GET https://localhost:7257/api/Auth/me - 200 null application/json; charset=utf-8 107.1677ms
2026-01-07 22:55:08 [INF] Request starting HTTP/2 OPTIONS https://localhost:7257/api/SMS - null null
2026-01-07 22:55:08 [INF] CORS policy execution successful.
2026-01-07 22:55:08 [INF] Request finished HTTP/2 OPTIONS https://localhost:7257/api/SMS - 204 null null 6.2002ms
2026-01-07 22:55:08 [INF] Request starting HTTP/2 POST https://localhost:7257/api/SMS - application/json 128
2026-01-07 22:55:08 [INF] CORS policy execution successful.
2026-01-07 22:55:08 [INF] Executing endpoint 'VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API)'
2026-01-07 22:55:08 [INF] Route matched with {action = "SendSMS", controller = "SMS"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendSMS(SendSMSRequest) on controller VoIPPlatform.API.Controllers.SMSController (VoIPPlatform.API).
2026-01-07 22:55:08 [INF] Processing SendSMS Request [VERSION 2]. UserId: 34, AccountId: 34
2026-01-07 22:55:08 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[AccountBalance], [u].[CreatedAt], [u].[Email], [u].[FirstName], [u].[IsActive], [u].[IsEmailVerified], [u].[LastLoginAt], [u].[LastName], [u].[PasswordHash], [u].[PhoneNumber], [u].[Role], [u].[UpdatedAt], [u].[Username]
FROM [Users] AS [u]
WHERE [u].[Id] = @__p_0
2026-01-07 22:55:08 [INF] Executed DbCommand (1ms) [Parameters=[@__request_UserId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccountType], [a].[Balance], [a].[CountryCode], [a].[CreatedAt], [a].[DeactivatedAt], [a].[IsActive], [a].[MonthlyUsage], [a].[RenewsAt], [a].[UserId], [a].[VirtualPhoneNumber]
FROM [Accounts] AS [a]
WHERE [a].[UserId] = @__request_UserId_0
2026-01-07 22:55:08 [INF] Sending SMS from 1234567890 to +46707524770 for account 34
2026-01-07 22:55:08 [INF] Sending SMS to +46707524770 from 1234567890
2026-01-07 22:55:08 [INF] Start processing HTTP request GET https://www.voicetrading.com/myaccount/sendsms.php?username=reninvoip1&password=NaTale1961&from=1234567890&to=%2B46707524770&text=Hi%20Mam%20Hur%20m%C3%A5r%20du%3F
2026-01-07 22:55:08 [INF] Sending HTTP request GET https://www.voicetrading.com/myaccount/sendsms.php?username=reninvoip1&password=NaTale1961&from=1234567890&to=%2B46707524770&text=Hi%20Mam%20Hur%20m%C3%A5r%20du%3F
2026-01-07 22:55:28 [INF] Received HTTP response headers after 20227.832ms - 200
2026-01-07 22:55:28 [INF] End processing HTTP request after 20233.1272ms - 200
2026-01-07 22:55:28 [INF] SMS sent successfully (XML Format). Response: <?xml version="1.0" encoding="utf-8"?> 
<SmsResponse>
    <version>1</version>
    <result>1</result> 
    <resultstring>success</resultstring>
    <description></description>
    <partcount>1</partcount>
    <endcause></endcause>
    <browserID>0</browserID>
    <lsID>none</lsID>
    <sessionkey>ushe8ua9gsea7laglqkhlkp092</sessionkey>
    <campaignID></campaignID>
</SmsResponse>
2026-01-07 22:55:28 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2026-01-07 22:55:28 [INF] Executed DbCommand (2ms) [Parameters=[@p2='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32), @p4='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p5='?' (DbType = DateTime2), @p6='?' (Size = 500), @p7='?' (Size = 100), @p8='?' (Size = 1000), @p9='?' (DbType = Int32), @p10='?' (Size = 4000), @p11='?' (Size = 4000), @p12='?' (DbType = DateTime2), @p13='?' (Size = 50), @p14='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Accounts] SET [Balance] = @p0, [MonthlyUsage] = @p1
OUTPUT 1
WHERE [Id] = @p2;
INSERT INTO [SMS] ([AccountId], [Cost], [CreatedAt], [ErrorMessage], [ExternalId], [MessageContent], [MessageLength], [RecipientNumber], [SenderNumber], [SentAt], [Status], [UserId])
OUTPUT INSERTED.[Id]
VALUES (@p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
2026-01-07 22:55:28 [ERR] An exception occurred in the database while saving changes for context type 'VoIPPlatform.API.Models.VoIPDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ac12f4b3-9a67-4ab2-9be6-cb0ff99b370e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ac12f4b3-9a67-4ab2-9be6-cb0ff99b370e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2026-01-07 22:55:29 [ERR] Error sending SMS
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ac12f4b3-9a67-4ab2-9be6-cb0ff99b370e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 242
2026-01-07 22:55:29 [ERR] Unexpected error in SendSMS.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_SMS_Accounts_AccountId". The conflict occurred in database "VoIPPlatformDb", table "dbo.Accounts", column 'Id'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:ac12f4b3-9a67-4ab2-9be6-cb0ff99b370e
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 242
   at VoIPPlatform.API.Controllers.SMSController.SendSMS(SendSMSRequest request) in C:\Users\mejer\Desktop\VoIPPlatform\VoIPPlatform.API\VoIPPlatform.API\Controllers\SMSController.cs:line 316
2026-01-07 22:55:29 [INF] Executed action VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API) in 20352.8267ms
2026-01-07 22:55:29 [INF] Executed endpoint 'VoIPPlatform.API.Controllers.SMSController.SendSMS (VoIPPlatform.API)'
2026-01-07 22:55:29 [INF] Request finished HTTP/2 POST https://localhost:7257/api/SMS - 500 null application/json; charset=utf-8 20421.5746ms
